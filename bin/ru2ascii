#!/usr/bin/env lua
---------------------------------------------------------------------
--     This Lua5 script is Copyright (c) 2022, Peter J Billam      --
--                         pjb.com.au                              --
--  This script is free software; you can redistribute it and/or   --
--         modify it under the same terms as Lua5 itself.          --
---------------------------------------------------------------------
local Version = '1.0  for Lua5'
local VersionDate  = '14mar2022'
local Synopsis = [[
  ru2ascii [options] [filenames]
]]
local function printf (...) io.stdout:write(string.format(...)) end
local iarg=1; while arg[iarg] ~= nil do
	if not string.find(arg[iarg], '^-[a-z]') then break end
	local first_letter = string.sub(arg[iarg],2,2)
	if first_letter == 'v' then
		local n = string.gsub(arg[0],"^.*/","",1)
		print(n.." version "..Version.."  "..VersionDate)
		os.exit(0)
	elseif first_letter == 'c' then
		whatever()
	else
		local n = string.gsub(arg[0],"^.*/","",1)
		print(n.." version "..Version.."  "..VersionDate.."\n\n"..Synopsis)
		os.exit(0)
	end
	iarg = iarg+1
end
if arg[iarg] then F = assert(io.open(arg[iarg], 'r')) else F = io.stdin end
local c = {utf8.codepoint(F:read('a'),1,-1)}

local codepoint2ascii = {
	[0x0410] = 'A',  [0x0411] = 'B',   [0x0412] = 'V',  [0x0413] = 'G',
	[0x0414] = 'D',  [0x0415] = 'YE',  [0x0416] = 'ZH', [0x0417] = 'Z',
	[0x0418] = 'I',  [0x0419] = 'Y',   [0x041A] = 'K',  [0x041B] = 'L',
	[0x041C] = 'M',  [0x041D] = 'N',   [0x041E] = 'O',  [0x041F] = 'P',
	[0x0420] = 'R',  [0x0421] = 'S',   [0x0422] = 'T',  [0x0423] = 'U',
	[0x0424] = 'F',  [0x0425] = 'KH',  [0x0426] = 'TS', [0x0427] = 'CH',
	[0x0428] = 'SH', [0x0429] = 'SCH', [0x042A] = '"',  [0x042B] = 'Y',
	[0x042C] = "'",  [0x042D] = 'E',   [0x042E] = 'YU', [0x042F] = 'YA',
	[0x0430] = 'a',  [0x0431] = 'b',   [0x0432] = 'v',  [0x0433] = 'g',
	[0x0434] = 'd',  [0x0435] = 'ye',  [0x0436] = 'zh', [0x0437] = 'z',
	[0x0438] = 'i',  [0x0439] = 'y',   [0x043A] = 'k',  [0x043B] = 'l',
	[0x043C] = 'm',  [0x043D] = 'n',   [0x043E] = 'o',  [0x043F] = 'p',
	[0x0440] = 'r',  [0x0441] = 's',   [0x0442] = 't',  [0x0443] = 'u',
	[0x0444] = 'f',  [0x0445] = 'kh',  [0x0446] = 'ts', [0x0447] = 'ch',
	[0x0448] = 'sH', [0x0449] = 'sch', [0x044A] = '"',  [0x044B] = 'y',
	[0x044C] = "'",  [0x044D] = 'e',   [0x044E] = 'yu', [0x044F] = 'ya',
}

local char = string.char
function ru2str (v) return codepoint2ascii[v] or char(v) end

local strtab = {}
local insert = table.insert
for i,v in ipairs(c) do insert(strtab, ru2str(v)) end

io.write(table.concat(strtab, ''))

--[=[

=pod

=head1 NAME

ru2ascii - what it does

=head1 SYNOPSIS

 ru2ascii infile > outfile

=head1 DESCRIPTION

This script

d0 90  d0 91  d0 92  d0 93  d0 94  d0 95  d0 96  d0 97
d0 98  d0 99  d0 9a  d0 9b  d0 9c  d0 9d  d0 9e  d0 9f
d0 a0  d0 a1  d0 a2  d0 a3  d0 a4  d0 a5  d0 a6  d0 a7
d0 a8  d0 a9  d0 aa  d0 ab  d0 ac  d0 ad  d0 ae  d0 af

d0 b0  d0 b1  d0 b2  d0 b3  d0 b4  d0 b5  d0 b6  d0 b7
d0 b8  d0 b9  d0 ba  d0 bb  d0 bc  d0 bd  d0 be  d0 bf
d0 c0  d0 c1  d0 c2  d0 c3  d0 c4  d0 c5  d0 c6  d0 c7
d0 c8  d0 c9  d0 ca  d0 cb  d0 cc  d0 cd  d0 ce  d0 cf

=head1 ARGUMENTS

=over 3

=item I<-v>

Print the Version

=back

=head1 DOWNLOAD

This at is available at

=head1 AUTHOR

Peter J Billam, https://pjb.com.au/comp/contact.html

=head1 SEE ALSO

 https://pjb.com.au/

=cut

]=]
